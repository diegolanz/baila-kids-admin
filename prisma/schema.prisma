generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Student {
  id                String         @id @default(uuid())
  studentName       String
  age               Int
  parentName        String
  phone             String
  email             String
  location          SchoolLocation
  frequency         ClassFrequency
  selectedDays      String[]
  startDate         DateTime
  paymentStatus     PaymentStatus  @default(PENDING)
  paymentMethod     String?
  liabilityAccepted Boolean        @default(false)
  waiverName        String?
  waiverAddress     String?
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  session           Session        @default(FALL_2024)
  Enrollment        Enrollment[]
}

model WaitingList {
  id           String         @id
  studentName  String
  age          Int
  parentName   String
  phone        String
  email        String
  location     SchoolLocation
  requestedDay String
  notes        String?
  createdAt    DateTime       @default(now())
  session      Session        @default(FALL_2024)
}

model AppConfig {
  key       String   @id
  value     String
  updatedAt DateTime
}

model ClassSection {
  id         String         @id
  location   SchoolLocation
  day        Day
  label      String         @default("A")
  startDate  DateTime?
  startTime  String?
  endTime    String?
  capacity   Int            @default(22)
  priceCents Int
  isActive   Boolean        @default(true)
  session    Session        @default(FALL_2024)
  Enrollment Enrollment[]

  @@unique([location, day, label, session])
}

model Enrollment {
  id           String           @id
  studentId    String
  sectionId    String
  status       EnrollmentStatus @default(ACTIVE)
  createdAt    DateTime         @default(now())
  session      Session          @default(FALL_2024)
  ClassSection ClassSection     @relation(fields: [sectionId], references: [id])
  Student      Student          @relation(fields: [studentId], references: [id])

  @@unique([studentId, sectionId])
}

enum SchoolLocation {
  KATY
  SUGARLAND
}

enum ClassFrequency {
  ONCE_A_WEEK
  TWICE_A_WEEK
}

enum PaymentStatus {
  PENDING
  PAID
  FAILED
}

enum Day {
  Monday
  Tuesday
  Wednesday
  Thursday
  Friday
}

enum EnrollmentStatus {
  ACTIVE
  WAITLISTED
  CANCELLED
}

enum Session {
  FALL_2024
  SPRING_2025
  FALL_2025
  SPRING_2026
}
